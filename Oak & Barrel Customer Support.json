{
  "name": "Oak & Barrel Customer Support",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        0,
        0
      ],
      "id": "089d89ee-2738-4e4c-bb86-e789bd6812a4",
      "name": "When chat message received",
      "webhookId": "e6207365-6c00-4e4f-8e15-b2c23d8aed6c"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=Your name is Luna, a customer support agent for a restaurant called the Oak & Barrel.\n\nYour role is to answer questions about the restaurant by using the Oak & Barrel knowledge base tool.\n\nYour responses should be friendly and concise.\n\nIf a user requests to make a reservation, you need to do the following:\n- Collect their name, email, party size, date and time, and any special requirements (optional).\n- Use the Make Reservation tool to send an email to the restaurant to make the reservation.\n- Inform the user that their request was sent to the restaurant and that the restaurant will confirm the reservation.\n\nIf a user requests to speak to a human, you need to do the following:\n- Collect their name, email or a phone number.\n- Send an email using the Request Human Support tool.\n\nIf a user makes a request regarding an item that is not related to the Oak & Barrel restaurant, politely indicate that you can only provide information regarding the restaurant. Requests that are considered restaurant-related would include items in the FAQ, appetizers, dishes, desserts, drinks, bar, contact information, reservations, customer support, prices, menu, dress code, hours of operation, website, and such.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        208,
        0
      ],
      "id": "419f03d0-cf7c-44d3-9ca1-17a5f9890f32",
      "name": "Luna"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        80,
        208
      ],
      "id": "8c60c306-7a56-4a49-8e41-8221088224c7",
      "name": "GPT-4.1-MINI",
      "credentials": {
        "openAiApi": {
          "id": "hbH9DM4TcdsgrFO9",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        352,
        384
      ],
      "id": "0b8c4ec8-363c-4baa-81fb-3fc9d9691352",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "hbH9DM4TcdsgrFO9",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "vijay.nadkarni@galenogen.com",
        "subject": "New reservation at Oak & Barrel",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        640,
        208
      ],
      "id": "1d7b6378-8b6f-40b2-8b88-45c8ec4fb0dd",
      "name": "Make Reservation",
      "webhookId": "c08241ff-d8d6-4402-a7ea-dc4493a91c10",
      "credentials": {
        "gmailOAuth2": {
          "id": "GE1LYSns1IfilqmR",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "vjnadkarni2@gmail.com",
        "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
        "message": " ",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        768,
        208
      ],
      "id": "c474ee58-793d-4486-9ecc-7674165ef757",
      "name": "Send email to Support",
      "webhookId": "b52ee3c5-5d51-4601-898c-499f81dd5b17",
      "credentials": {
        "gmailOAuth2": {
          "id": "GE1LYSns1IfilqmR",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "n8n-tutorial-key",
        "contextWindowLength": 100
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        224,
        208
      ],
      "id": "36931343-770d-4788-bcf1-9a7e8b78d45c",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "aI6ml1gn3sJmXRl4",
          "name": "Postgres account 4"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Use this to retrieve documents related to the Oak & Barrel restaurant",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
      "typeVersion": 1.3,
      "position": [
        352,
        208
      ],
      "id": "effc569e-18e3-4480-a188-4a3f31a3069c",
      "name": "Postgres PGVector Store",
      "credentials": {
        "postgres": {
          "id": "aI6ml1gn3sJmXRl4",
          "name": "Postgres account 4"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "Luna",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GPT-4.1-MINI": {
      "ai_languageModel": [
        [
          {
            "node": "Luna",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Postgres PGVector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Make Reservation": {
      "ai_tool": [
        [
          {
            "node": "Luna",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Luna": {
      "main": [
        []
      ]
    },
    "Send email to Support": {
      "ai_tool": [
        [
          {
            "node": "Luna",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "Luna",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Postgres PGVector Store": {
      "ai_tool": [
        [
          {
            "node": "Luna",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "8faaad33-8c7c-4c30-9908-5814dd8a9b89",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "94747082daca9746a73dd94f1d165c8cd574c30c72cf8bce262fa88d08f29660"
  },
  "id": "zUNOovvJGo2767hi",
  "tags": []
}